---
title: "反卷数学局 - 组合数学的奇妙冒险2"
description: "探讨线性方程在非负整数和正整数约束下的解的个数，介绍隔板法和生成函数等经典求解技巧"
date: 2025-05-11 
tags: ["隔板法", "生成函数", "排列组合"]
category: "组合数学"
draft: false
---

# 解密整数方程：非负解与正整数解的奥秘

在组合数学中，求解形如 $x_1 + x_2 + \cdots + x_n = m$ 的线性方程的整数解个数是一个非常经典且基础的问题。这个问题根据对变量 $x_i$ 的约束不同，其解法和结果也会有所差异。本文将重点探讨两种最基本的情况：

1.  当 $x_i$ 为 **非负整数** ($x_i \ge 0$) 时，方程解的个数。
2.  当 $x_i$ 为 **正整数** ($x_i \ge 1$) 时，方程解的个数。

这两种情况可以形象地理解为“放球模型”：将 $m$ 个相同的球放入 $n$ 个不同的盒子中。非负整数解对应允许盒子为空，而正整数解对应每个盒子至少有一个球。

## 1. 非负整数解 ($x_i \ge 0$)

我们首先考虑方程 $x_1 + x_2 + \cdots + x_n = m$ 的非负整数解（即 $x_i \ge 0$）的个数，其中 $m$ 为非负整数，$n$ 为正整数。

### 方法一：隔板法 (Stars and Bars)

这是解决此类问题非常直观的方法。

*   **思想**：想象我们有 $m$ 个相同的“星星”（`*`），代表总和 $m$。为了将这些星星分成 $n$ 组（对应 $x_1, \dots, x_n$ 的值），我们需要 $n-1$ 个“隔板”（`|`）。
*   **推导**：例如，如果 $n=3, m=5$，一个可能的排列是 `**|*|**`，这对应解 $x_1=2, x_2=1, x_3=2$。由于允许 $x_i=0$，隔板可以相邻，或者出现在所有星星的最左边/最右边（例如 `||*****` 表示 $x_1=0, x_2=0, x_3=5$）。
    我们总共有 $m$ 个星星和 $n-1$ 个隔板，占据了 $m+n-1$ 个位置。问题就转化为在这 $m+n-1$ 个位置中选择 $n-1$ 个位置放置隔板（其余位置自动成为星星）。
*   **公式**：非负整数解的个数为：
    $$ N_0 = \binom{m+n-1}{n-1} = \binom{m+n-1}{m} $$

**示例**：求 $x_1 + x_2 + x_3 = 2$ ($m=2, n=3$) 的非负整数解个数。
根据公式，解的个数为 $\binom{2+3-1}{3-1} = \binom{4}{2} = \frac{4 \times 3}{2 \times 1} = 6$。
这些解是：(2,0,0), (0,2,0), (0,0,2), (1,1,0), (1,0,1), (0,1,1)。

### 方法二：生成函数法

生成函数为计数问题提供了强大的代数工具。

*   **思想**：对于每个变量 $x_i \ge 0$，其可能的取值对总和的贡献可以用形式幂级数 $G_i(z) = z^0 + z^1 + z^2 + \cdots = \sum_{k=0}^{\infty} z^k = \frac{1}{1-z}$ 来表示。
*   **推导**：对于 $n$ 个变量，总的生成函数是这些级数的乘积：
    $$ G(z) = \left(\frac{1}{1-z}\right)^n = (1-z)^{-n} $$
    我们要求的是 $G(z)$ 展开式中 $z^m$ 项的系数。根据广义二项式定理（牛顿二项式定理）：
    $$ (1-x)^{-\alpha} = \sum_{k=0}^{\infty} \binom{\alpha+k-1}{k} x^k = \sum_{k=0}^{\infty} \binom{\alpha+k-1}{\alpha-1} x^k $$
    令 $x=z, \alpha=n, k=m$，则 $z^m$ 的系数为 $\binom{n+m-1}{m}$，即 $\binom{m+n-1}{m}$。
*   **公式**：结果与隔板法一致：
    $$ [z^m](1-z)^{-n} = \binom{m+n-1}{m} $$

## 2. 正整数解 ($x_i \ge 1$)

接下来，我们考虑方程 $x_1 + x_2 + \cdots + x_n = m$ 的正整数解（即 $x_i \ge 1$）的个数。

### 方法一：变量代换 (转化为非负整数解)

这是最常用的方法。

*   **思想**：既然要求 $x_i \ge 1$，我们可以引入新变量 $y_i = x_i - 1$。这样，$y_i \ge 0$ 就变成了非负整数。
*   **推导**：将 $x_i = y_i + 1$ 代入原方程：
    $$ (y_1+1) + (y_2+1) + \cdots + (y_n+1) = m $$
    $$ y_1 + y_2 + \cdots + y_n + n = m $$
    $$ y_1 + y_2 + \cdots + y_n = m-n $$
    现在问题转化为求此新方程关于 $y_i$ 的非负整数解。令 $m' = m-n$。使用上一节的非负整数解公式，解的个数为 $\binom{m'+n-1}{n-1} = \binom{(m-n)+n-1}{n-1} = \binom{m-1}{n-1}$。
    **重要条件**：为使 $y_i$ 有非负整数解，必须有 $m' = m-n \ge 0$，即 $m \ge n$。如果 $m < n$，则一个非负整数之和不可能为负数，所以解的个数为0。
*   **公式**：正整数解的个数为 (当 $m \ge n$ 时)：
    $$ N_1 = \binom{m-1}{n-1} = \binom{m-1}{m-n} $$
    若 $m < n$，则 $N_1 = 0$。

**示例**：求 $x_1 + x_2 + x_3 = 5$ ($m=5, n=3$) 的正整数解个数。
这里 $m \ge n$。解的个数为 $\binom{5-1}{3-1} = \binom{4}{2} = 6$。
这些解是：(1,1,3), (1,3,1), (3,1,1), (1,2,2), (2,1,2), (2,2,1)。

### 方法二：隔板法 (插空法)

*   **思想**：将 $m$ 个星星 `* * * ... *` 排成一行。因为每个 $x_i$ 必须是正数，所以隔板不能相邻，也不能在两端。这 $m$ 个星星之间形成了 $m-1$ 个可供插入隔板的空隙。
*   **推导**：我们需要将 $n-1$ 个隔板插入到这 $m-1$ 个空隙中，以将星星分成 $n$ 份。从 $m-1$ 个空隙中选择 $n-1$ 个位置放置隔板。
*   **公式**：方案数为 $\binom{m-1}{n-1}$。这自然要求 $m-1 \ge n-1$，即 $m \ge n$。

### 方法三：生成函数法

*   **思想**：对于每个变量 $x_i \ge 1$，其对应的生成函数为 $G'_i(z) = z^1 + z^2 + z^3 + \cdots = z(1+z+z^2+\dots) = \frac{z}{1-z}$。
*   **推导**：总的生成函数为：
    $$ G'(z) = \left(\frac{z}{1-z}\right)^n = z^n (1-z)^{-n} $$
    我们要求 $G'(z)$ 中 $z^m$ 的系数，这等价于在 $(1-z)^{-n}$ 的展开式中找到 $z^{m-n}$ 项的系数。
    根据上一节的广义二项式定理，令 $k = m-n$，系数为 $\binom{n+(m-n)-1}{m-n} = \binom{m-1}{m-n}$。
*   **公式**：结果与前述方法一致：
    $$ [z^m] z^n(1-z)^{-n} = \binom{m-1}{m-n} = \binom{m-1}{n-1} $$

## 公式总结与关系

1.  **非负整数解 ($x_i \ge 0$) 个数**：
    $$ N_0(m,n) = \binom{m+n-1}{n-1} $$
    (适用条件: $m \ge 0$, $n \ge 1$)

2.  **正整数解 ($x_i \ge 1$) 个数**：
    $$ N_1(m,n) = \binom{m-1}{n-1} $$
    (适用条件: $m \ge n \ge 1$; 若 $m < n$, 解数为0)

可以观察到，正整数解问题可以通过变量代换 $y_i = x_i - 1$ 直接转化为总和为 $m-n$ 的非负整数解问题。这清晰地揭示了两种问题之间的内在联系。

## 应用与扩展

这些基本计数原理有着广泛的应用：

1.  **物品分配问题**：如 $m$ 个相同苹果分给 $n$ 个不同的人。
2.  **多重集组合**：从 $n$ 类物品（每类无限多）中选取 $m$ 个。
3.  **整数的合成 (Composition of an Integer)**：将正整数 $m$ 表示成 $n$ 个正整数之和的有序分解方案数。
4.  **计算机科学中的资源分配**。
5.  **更复杂约束**：若 $x_i \ge c_i$（$c_i$ 为某整数），可类似代换 $y_i = x_i - c_i$ 求解。若有上界约束，则通常需结合容斥原理或更复杂的生成函数技巧。

## 结语

线性方程的整数解计数问题是组合数学的基石。隔板法以其直观性帮助我们理解问题本质，而生成函数法则提供了更为系统和强大的代数工具，能够应对更复杂的情况。掌握这些方法对于解决各类组合计数问题至关重要。